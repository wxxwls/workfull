<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>산재 신청 폼</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background-color: #e9f7ef;
        }

        .form-container {
            margin-top: 5vh;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .form-control:focus {
            border-color: #28a745;
            box-shadow: 0 0 8px rgba(40, 167, 69, 0.1);
        }

        .form-label {
            color: #28a745;
        }

        .btn-submit {
            background-color: #28a745;
            color: white;
            border: none;
        }

        .btn-submit:hover {
            background-color: #218838;
        }

        .btn-back {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: transparent;
            border: none;
            font-size: 1.5rem;
            color: #28a745;
        }

        .btn-back:hover {
            color: #218838;
        }

        .btn-find {
            background-color: #007bff;
            color: white;
        }

        .btn-find:hover {
            background-color: #0056b3;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-8 col-lg-6">
                <div class="form-container">
                    <!-- 뒤로가기 버튼 (아이콘) -->
                    <button class="btn-back" onclick="history.back()">
                        <i class="bi bi-arrow-left-circle"></i>
                    </button>

                    <h2 class="text-center mb-4" style="color: #28a745;">산재 신청</h2>
                    <form method="post" enctype="multipart/form-data" id="injuryForm">
                        {% csrf_token %}
                        <!-- 이름 -->
                        <div class="mb-3">
                            <label for="name" class="form-label">이름</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>

                        <!-- 주민등록번호 -->
                        <div class="mb-3">
                            <label for="id_number" class="form-label">주민등록번호</label>
                            <input type="text" class="form-control" id="id_number" name="id_number" maxlength="13"
                                required>
                        </div>

                        <!-- 주소 -->
                        <div class="mb-3">
                            <label for="address" class="form-label">주소</label>
                            <input type="text" class="form-control" id="address" name="address" required>
                        </div>

                        <!-- 전화번호 -->
                        <div class="mb-3">
                            <label for="phone" class="form-label">전화번호</label>
                            <input type="text" class="form-control" id="phone" name="phone" required>
                        </div>

                        <!-- 근무 시작 시간 -->
                        <div class="mb-3">
                            <label for="start_time" class="form-label">근무 시작 시간</label>
                            <input type="time" class="form-control" id="start_time" name="start_time" required>
                        </div>

                        <!-- 근무 종료 시간 -->
                        <div class="mb-3">
                            <label for="end_time" class="form-label">근무 종료 시간</label>
                            <input type="time" class="form-control" id="end_time" name="end_time" required>
                        </div>

                        <!-- 직업 유형 -->
                        <div class="mb-3">
                            <label for="job_type" class="form-label">직업 유형</label>
                            <input type="text" class="form-control" id="job_type" name="job_type" required>
                        </div>

                        <!-- 보험 관계 -->
                        <div class="mb-3">
                            <label for="relation_with_insured" class="form-label">보험 관계</label>
                            <select class="form-select" id="relation_with_insured" name="relation_with_insured" required>
                                <option value="none">해당없음</option>
                                <option value="actual_employer">실제사업주(동업자포함)</option>
                                <option value="sub_contractor">하수급사업주</option>
                            </select>
                        </div>

                        <!-- 가족 관계 -->
                        <div class="mb-3">
                            <label for="family_relation" class="form-label">가족 관계</label>
                            <select class="form-select" id="family_relation" name="family_relation" required>
                                <option value="none">해당없음</option>
                                <option value="spouse">배우자</option>
                                <option value="parent">부모</option>
                                <option value="child">자녀</option>
                                <option value="sibling">형제자매</option>
                                <option value="other_relative">기타친인척</option>
                            </select>
                        </div>

                        <!-- 신청 유형 -->
                        <div class="mb-3">
                            <label for="application_type" class="form-label">신청 유형</label>
                            <select class="form-select" id="application_type" name="application_type" required>
                                <option value="work_accident">업무상 사고</option>
                                <option value="work_disease">업무상 질병</option>
                                <option value="commute_accident">출퇴근 재해</option>
                            </select>
                        </div>

                        <!-- 사업장 정보 -->
                        <div class="mb-3">
                            <label for="business_name" class="form-label">사업장 이름</label>
                            <input type="text" class="form-control" id="business_name" name="business_name" required>
                        </div>

                        <div class="mb-3">
                            <label for="business_owner_name" class="form-label">사업주 이름</label>
                            <input type="text" class="form-control" id="business_owner_name" name="business_owner_name"
                                required>
                        </div>

                        <div class="mb-3">
                            <label for="business_management_number" class="form-label">사업장 관리번호</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="business_management_number"
                                    name="business_management_number" required>
                                <button type="button" class="btn btn-find" onclick="window.open('https://www.comwel.or.kr/comwel/paym/insu/srch.jsp', '_blank')">사업장 찾아보기</button>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="business_address" class="form-label">사업장 주소</label>
                            <input type="text" class="form-control" id="business_address" name="business_address"
                                required>
                        </div>

                        <!-- 사고 설명 -->
                        <div class="mb-3">
                            <label for="accident_description" class="form-label">사고 설명</label>
                            <textarea class="form-control" id="accident_description" name="accident_description" rows="3"
                                required></textarea>
                        </div>

                        <!-- 체크박스들 -->
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="checkbox_one" name="checkbox_one">
                            <label class="form-check-label" for="checkbox_one">1. 위 재해와 관련하여 교통사고, 음주, 폭행 등의 사유로 경찰서에 신고(접수)된 사실이
                                있습니까?</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="checkbox_two" name="checkbox_two">
                            <label class="form-check-label" for="checkbox_two">2. 위 재해와 관련하여 119 또는 소방서에 구조구급, 재난 신고(접수)된 사실이
                                있습니까?</label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="checkbox_three" name="checkbox_three">
                            <label class="form-check-label" for="checkbox_three">3. 위 재해와 관련하여 자동차 보험사에 사고를 신고한 사실이 있습니까?</label>
                        </div>

                        <!-- 목격자 정보 -->
                        <div class="mb-3">
                            <label for="witness_name" class="form-label">목격자 이름</label>
                            <input type="text" class="form-control" id="witness_name" name="witness_name">
                        </div>

                        <div class="mb-3">
                            <label for="witness_contact" class="form-label">목격자 연락처</label>
                            <input type="text" class="form-control" id="witness_contact" name="witness_contact">
                        </div>

                        <div class="mb-3">
                            <label for="witness_relation" class="form-label">목격자 관계</label>
                            <input type="text" class="form-control" id="witness_relation" name="witness_relation">
                        </div>

                        <!-- 수령 여부 -->
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="has_received_compensation"
                                name="has_received_compensation">
                            <label class="form-check-label" for="has_received_compensation">수령 여부</label>
                        </div>

                        <!-- 수령 정보 -->
                        <div class="mb-3">
                            <label for="receipt_date" class="form-label">수령일자</label>
                            <input type="date" class="form-control" id="receipt_date" name="receipt_date">
                        </div>

                        <div class="mb-3">
                            <label for="receipt_amount" class="form-label">수령금액</label>
                            <input type="number" class="form-control" id="receipt_amount" name="receipt_amount" step="0.01">
                        </div>

                        <div class="mb-3">
                            <label for="payment_source" class="form-label">지급처</label>
                            <input type="text" class="form-control" id="payment_source" name="payment_source">
                        </div>

                        <!-- 첨부 서류 -->
                        <div class="mb-3">
                            <label for="attached_documents" class="form-label">첨부 서류</label>
                            <input type="file" class="form-control" id="attached_documents" name="attached_documents">
                        </div>

                        <!-- 저장하기 버튼 -->
                        <button type="submit" class="btn btn-submit w-100">저장하기</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 세션 스토리지를 사용하여 폼 데이터를 유지하는 스크립트 -->
    <script>
        // 폼 데이터를 세션 스토리지에 저장하는 함수
        function saveFormData() {
            let formData = {};
            const formElements = document.querySelectorAll('#injuryForm input, #injuryForm select, #injuryForm textarea');
            
            formElements.forEach(element => {
                if (element.type === 'checkbox') {
                    formData[element.id] = element.checked;
                } else {
                    formData[element.id] = element.value;
                }
            });
            
            sessionStorage.setItem('injuryFormData', JSON.stringify(formData));
        }

        // 세션 스토리지에서 폼 데이터를 불러오는 함수
        function loadFormData() {
            const savedData = JSON.parse(sessionStorage.getItem('injuryFormData'));
            if (savedData) {
                for (let id in savedData) {
                    const element = document.getElementById(id);
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = savedData[id];
                        } else {
                            element.value = savedData[id];
                        }
                    }
                }
            }
        }

        // 폼 데이터가 변경될 때마다 자동으로 저장
        document.getElementById('injuryForm').addEventListener('input', saveFormData);

        // 페이지가 로드될 때 저장된 데이터를 불러옴
        window.onload = loadFormData;
    </script>
</body>

</html>
